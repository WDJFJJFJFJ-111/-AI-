# ═══════════════════════════════════════════════════════════════
#                    TrendRadar 配置文件
#                      Version: 2.0.0
# ═══════════════════════════════════════════════════════════════

# 可视化配置编辑器地址: https://sansan0.github.io/TrendRadar/

# ===============================================================
# 1. 基础设置
# ===============================================================
app:
  timezone: "Asia/Shanghai"
  show_version_update: false

# ===============================================================
# 1.5 调度系统
# ===============================================================
schedule:
  enabled: true
  preset: "morning_evening"

# ===============================================================
# 2. 数据源 - 强制抓取详情+无缓存
# ===============================================================
platforms:
  enabled: true
  fetch_detail: true
  force_refetch: true  # 【核心】强制每次重新抓取，不用缓存数据
  detail_only_with_url: false  # 【核心】只要有链接就抓详情，不做过滤
  sources:
    - id: "wallstreetcn-hot"
      name: "华尔街见闻"
      fetch_detail: true
      force_refetch: true
      detail_timeout: 10000
    - id: "cls-hot"
      name: "财联社热门"
      fetch_detail: true
      force_refetch: true
      detail_timeout: 10000

# ===============================================================
# 3. 数据源 - RSS 订阅（兜底备用，自带摘要）
# ===============================================================
rss:
  enabled: false
  freshness_filter:
    enabled: true
    max_age_days: 1
  feeds: []

# ===============================================================
# 4. 报告模式（强制显示摘要）
# ===============================================================
report:
  mode: "current"
  display_mode: "platform"
  sort_by_position_first: false
  rank_threshold: 3
  max_news_per_keyword: 10
  # 【强制显示摘要所有开关】
  show_detail: true
  detail_max_length: 300
  detail_indent: true
  show_publish_time: true
  # 【核心】就算摘要为空也显示占位，确认开关是否生效
  show_empty_detail: true

# ===============================================================
# 5. 推送内容控制
# ===============================================================
display:
  region_order:
    - hotlist
  regions:
    hotlist: true
    new_items: false
    rss: false
    standalone: false
    ai_analysis: false

  standalone:
    platforms: []
    rss_feeds: []
    max_items: 0

# ===============================================================
# 6. 推送通知（企业微信）
# ===============================================================
notification:
  enabled: true
  channels:
    wework:
      enabled: true
      webhook_url: ""
      msg_type: "markdown"
    # 其他推送渠道全部清空
    feishu:
      webhook_url: ""
    dingtalk:
      webhook_url: ""
    telegram:
      bot_token: ""
      chat_id: ""
    email:
      from: ""
      password: ""
      to: ""
      smtp_server: ""
      smtp_port: ""
    ntfy:
      server_url: ""
      topic: ""
      token: ""
    bark:
      url: ""
    slack:
      webhook_url: ""
    generic_webhook:
      webhook_url: ""
      payload_template: ""

# ===============================================================
# 7. 存储配置（强制清缓存，不用旧数据）
# ===============================================================
storage:
  backend: "auto"
  formats:
    sqlite: true
    txt: false
    html: false
  local:
    data_dir: "output"
    retention_days: 1  # 只保留1天数据，每天强制清缓存
  remote:
    retention_days: 0
    endpoint_url: ""
    bucket_name: ""
    access_key_id: ""
    secret_access_key: ""
    region: ""
  pull:
    enabled: false
    days: 1

# ===============================================================
# 8. AI 模型配置（关闭）
# ===============================================================
ai:
  model: ""
  api_key: ""
  api_base: ""
  timeout: 120
  temperature: 1.0
  max_tokens: 0
  num_retries: 0
  fallback_models: []

# ===============================================================
# 9. AI 分析功能（关闭）
# ===============================================================
ai_analysis:
  enabled: false
  language: "Chinese"
  prompt_file: "ai_analysis_prompt.txt"
  mode: "follow_report"
  max_news_for_analysis: 0
  include_rss: false
  include_standalone: false
  include_rank_timeline: false

# ===============================================================
# 10. AI 翻译功能（关闭）
# ===============================================================
ai_translation:
  enabled: false
  language: "中文"
  prompt_file: "ai_translation_prompt.txt"

# ===============================================================
# 11. 高级设置
# ===============================================================
advanced:
  debug: true  # 开启debug，日志里会显示有没有抓到详情
  version_check_url: "https://raw.githubusercontent.com/sansan0/TrendRadar/refs/heads/master/version"
  mcp_version_check_url: "https://raw.githubusercontent.com/sansan0/TrendRadar/refs/heads/master/version_mcp"
  configs_version_check_url: "https://raw.githubusercontent.com/sansan0/TrendRadar/refs/heads/master/version_configs"

  crawler:
    request_interval: 3000  # 放慢请求速度，规避反爬
    use_proxy: false
    default_proxy: "http://127.0.0.1:10801"

  rss:
    request_interval: 1000
    timeout: 15
    use_proxy: false
    proxy_url: ""

  weight:
    rank: 0.6
    frequency: 0.3
    hotness: 0.1

  max_accounts_per_channel: 3

  batch_size:
    default: 3000
    dingtalk: 20000
    feishu: 30000
    bark: 4000
    slack: 4000
  batch_send_interval: 3
  feishu_message_separator: "━━━━━━━━━━━━━━━━"
